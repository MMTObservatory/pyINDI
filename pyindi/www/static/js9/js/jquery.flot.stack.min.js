(function(q){q.plot.plugins.push({init:function(q){q.hooks.processDatapoints.push(function(b,m,r){if(null!=m.stack&&!1!==m.stack){var h;b=b.getData();for(var f=null,g=0;g<b.length&&m!=b[g];++g)b[g].stack==m.stack&&(f=b[g]);if(h=f){b=r.pointsize;f=r.points;g=h.datapoints.pointsize;h=h.datapoints.points;var c=[],a,t=m.lines.show;var l=m.bars.horizontal;var q=2<b&&(l?r.format[2].x:r.format[2].y);m=t&&m.lines.steps;var u=!0;for(var x=l?1:0,n=l?0:1,e=0,k=0,d;!(e>=f.length);){d=c.length;if(null==f[e]){for(a=
0;a<b;++a)c.push(f[e+a]);e+=b}else if(k>=h.length){if(!t)for(a=0;a<b;++a)c.push(f[e+a]);e+=b}else if(null==h[k]){for(a=0;a<b;++a)c.push(null);u=!0;k+=g}else{var v=f[e+x];a=f[e+n];l=h[k+x];var p=h[k+n];var w=0;if(v==l){for(a=0;a<b;++a)c.push(f[e+a]);c[d+n]+=p;w=p;e+=b;k+=g}else if(v>l){if(t&&0<e&&null!=f[e-b]){u=a+(f[e-b+n]-a)*(l-v)/(f[e-b+x]-v);c.push(l);c.push(u+p);for(a=2;a<b;++a)c.push(f[e+a]);w=p}k+=g}else{if(u&&t){e+=b;continue}for(a=0;a<b;++a)c.push(f[e+a]);t&&0<k&&null!=h[k-g]&&(w=p+(h[k-g+
n]-p)*(v-l)/(h[k-g+x]-l));c[d+n]+=w;e+=b}u=!1;d!=c.length&&q&&(c[d+2]+=w)}if(m&&d!=c.length&&0<d&&null!=c[d]&&c[d]!=c[d-b]&&c[d+1]!=c[d-b+1]){for(a=0;a<b;++a)c[d+b+a]=c[d+a];c[d+1]=c[d-b+1]}}r.points=c}}})},options:{series:{stack:null}},name:"stack",version:"1.2"})})(jQuery);
