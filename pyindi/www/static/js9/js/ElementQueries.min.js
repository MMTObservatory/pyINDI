/*
 https://github.com/Mr0grog/element-query/blob/master/LICENSE

 @param {HTMLElement} element
 @param {*} value
 @returns {*}
*/
(function(k,c){"function"===typeof define&&define.amd?define(["./ResizeSensor.js"],c):"object"===typeof exports?module.exports=c(require("./ResizeSensor.js")):(k.ElementQueries=c(k.ResizeSensor),k.ElementQueries.listen())})("undefined"!==typeof window?window:this,function(k){var c=function(){function c(a){a||(a=document.documentElement);a=window.getComputedStyle(a,null).fontSize;return parseFloat(a)||16}function t(a,b){var d=b.split(/\d/);d=d[d.length-1];b=parseFloat(b);switch(d){case "px":return b;
case "em":return b*c(a);case "rem":return b*c();case "vw":return b*document.documentElement.clientWidth/100;case "vh":return b*document.documentElement.clientHeight/100;case "vmin":case "vmax":return b*(0,Math["vmin"===d?"min":"max"])(document.documentElement.clientWidth/100,document.documentElement.clientHeight/100);default:return b}}function x(a,b){var d,l;this.element=a;var h,c,g,e,f,n,p,q=["min-width","min-height","max-width","max-height"];this.call=function(){var a=this.element;a.getBoundingClientRect?
(a=a.getBoundingClientRect(),d=Math.round(a.width),l=Math.round(a.height)):(d=a.offsetWidth,l=a.offsetHeight);f={};for(h in m[b])m[b].hasOwnProperty(h)&&(c=m[b][h],g=t(this.element,c.value),e="width"===c.property?d:l,p=c.mode+"-"+c.property,n="","min"===c.mode&&e>=g&&(n+=c.value),"max"===c.mode&&e<=g&&(n+=c.value),f[p]||(f[p]=""),n&&-1===(" "+f[p]+" ").indexOf(" "+n+" ")&&(f[p]+=" "+n));for(var r in q)q.hasOwnProperty(r)&&(f[q[r]]?this.element.setAttribute(q[r],f[q[r]].substr(1)):this.element.removeAttribute(q[r]))}}
function y(a,b){a.elementQueriesSetupInformation||(a.elementQueriesSetupInformation=new x(a,b));a.elementQueriesSensor||(a.elementQueriesSensor=new k(a,function(){a.elementQueriesSetupInformation.call()}))}function z(a){var b;document.querySelectorAll&&(b=a?a.querySelectorAll.bind(a):document.querySelectorAll.bind(document));b||"undefined"===typeof $$||(b=$$);b||"undefined"===typeof jQuery||(b=jQuery);if(!b)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return b}function B(a){function b(){var b=
!1;for(l in d)d.hasOwnProperty(l)&&c[l].minWidth&&a.offsetWidth>c[l].minWidth&&(b=l);b||(b=g);if(e!==b)if(m[b])d[e].style.display="none",d[b].style.display="block",e=b;else{var l=new Image;l.onload=function(){d[b].src=h[b];d[e].style.display="none";d[b].style.display="block";m[b]=!0;e=b};l.src=h[b]}else d[b].src=h[b]}var d=[],c=[],h=[],g=0,e=-1,m=[],f;for(f in a.children)if(a.children.hasOwnProperty(f)&&a.children[f].tagName&&"img"===a.children[f].tagName.toLowerCase()){d.push(a.children[f]);var n=
a.children[f].getAttribute("min-width")||a.children[f].getAttribute("data-min-width"),p=a.children[f].getAttribute("data-src")||a.children[f].getAttribute("url");h.push(p);c.push({minWidth:n});n?a.children[f].style.display="none":(g=d.length-1,a.children[f].style.display="block")}e=g;a.resizeSensorInstance=new k(a,b);b()}function C(){for(var a=z()("[data-responsive-image],[responsive-image]"),b=0,d=a.length;b<d;b++)B(a[b])}function u(a){var b,d;for(a=a.replace(/'/g,'"');null!==(b=D.exec(a));){var c=
b[1]+b[3];for(b=b[2];null!==(d=E.exec(b));){var h=c,g=d[1],k=d[2];d=d[3];if("undefined"===typeof m[h]){m[h]=[];var t=v.length;e.innerHTML+="\n"+h+" {animation: 0.1s element-queries;}";e.innerHTML+="\n"+h+" > .resize-sensor {min-width: "+t+"px;}";v.push(h)}m[h].push({mode:g,property:k,value:d})}}}function w(a){if(a)if("string"===typeof a)a=a.toLowerCase(),-1===a.indexOf("min-width")&&-1===a.indexOf("max-width")||u(a);else for(var b=0,d=a.length;b<d;b++)if(1===a[b].type){var c=a[b].selectorText||a[b].cssText;
-1!==c.indexOf("min-height")||-1!==c.indexOf("max-height")?u(c):(-1!==c.indexOf("min-width")||-1!==c.indexOf("max-width"))&&u(c)}else 4===a[b].type?w(a[b].cssRules||a[b].rules):3===a[b].type&&a[b].styleSheet.hasOwnProperty("cssRules")&&w(a[b].styleSheet.cssRules)}var e,m={},v=[],D=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/mgi,E=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/mgi,A=!1;this.init=
function(){var a="animationstart";"undefined"!==typeof document.documentElement.style.webkitAnimationName?a="webkitAnimationStart":"undefined"!==typeof document.documentElement.style.MozAnimationName?a="mozanimationstart":"undefined"!==typeof document.documentElement.style.OAnimationName&&(a="oanimationstart");document.body.addEventListener(a,function(a){var b=a.target,c=b&&window.getComputedStyle(b,null);(c=c&&c.getPropertyValue("animation-name"))&&-1!==c.indexOf("element-queries")&&(b.elementQueriesSensor=
new k(b,function(){b.elementQueriesSetupInformation&&b.elementQueriesSetupInformation.call()}),c=window.getComputedStyle(b.resizeSensor,null).getPropertyValue("min-width"),c=parseInt(c.replace("px","")),y(a.target,v[c]))});A||(e=document.createElement("style"),e.type="text/css",e.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",e.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",
document.getElementsByTagName("head")[0].appendChild(e),A=!0);a=0;for(var b=document.styleSheets.length;a<b;a++)try{document.styleSheets[a].href&&0===document.styleSheets[a].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[a].href),w(document.styleSheets[a].cssRules||document.styleSheets[a].rules||document.styleSheets[a].cssText)}catch(d){}C()};this.findElementQueriesElements=function(a){var b=z(a),c;for(c in m)if(m.hasOwnProperty(c))for(var g=
b(c,a),e=0,k=g.length;e<k;e++)y(g[e],c)};this.update=function(){this.init()}};c.update=function(){c.instance.update()};c.detach=function(c){c.elementQueriesSetupInformation?(c.elementQueriesSensor.detach(),delete c.elementQueriesSetupInformation,delete c.elementQueriesSensor):c.resizeSensorInstance&&(c.resizeSensorInstance.detach(),delete c.resizeSensorInstance)};c.init=function(){c.instance||(c.instance=new c);c.instance.init()};var x=function(c){if(document.addEventListener)document.addEventListener("DOMContentLoaded",
c,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var g=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(c(),clearInterval(g))},10);else window.onload=c};c.findElementQueriesElements=function(g){c.instance.findElementQueriesElements(g)};c.listen=function(){x(c.init)};return c});
